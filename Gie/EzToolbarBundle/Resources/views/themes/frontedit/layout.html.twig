<!DOCTYPE html>
<html class="no-js" lang="{{ app.request.locale }}">
    <head>
        {% block seo_metas %}
            {% if location is defined and not location.isDraft %}
                {% include "NovaeZSEOBundle::seometas_head.html.twig" %}
            {% endif %}
        {% endblock %}
        
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="CSRF-Token" content="{{ csrf_token('authenticate') }}" />
        <meta name="SiteAccess" content="{{ app.request.get('siteaccess').name }}" />

        <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,700" rel="stylesheet">
        <link href="https://use.fontawesome.com/releases/v5.0.1/css/all.css" rel="stylesheet">
        <link href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" rel="stylesheet"
              integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
              crossorigin="" />

        <script>
          window.eZ = {
            addConfig: (path, value, shouldMerge = false) => {
              const keys = path.split('.');
              const lastIndex = keys.length - 1;
              const objectConstructorName = 'Object';
              const setValue = (newValue, oldValue) => {
                const hasValue = newValue && !!newValue.constructor;

                if (!shouldMerge || !hasValue) {
                  return newValue;
                }

                if (Array.isArray(oldValue) && Array.isArray(newValue)) {
                  return [...oldValue, ...newValue];
                }

                if (oldValue.constructor.name === objectConstructorName && newValue.constructor.name === objectConstructorName) {
                  return Object.assign({}, oldValue, newValue);
                }
              };

              keys.reduce((a, b, index) => {
                if (!a[b]) {
                  a[b] = {};
                }

                if (index === lastIndex) {
                  a[b] = setValue(value, a[b]);
                }

                return a[b];
              }, window.eZ);
            },
          };
        </script>
        <script>
          window.eZ.addConfig('adminUiConfig', {{ admin_ui_config|json_encode|raw }});
          window.eZ.addConfig('errors', {
            emailRegexp: /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,
            emptyField: '{{ 'js.error.empty.field'|trans({}, 'validators')|desc('{fieldName} field is required') }}',
            invalidEmail: '{{ 'js.error.invalid_email'|trans({}, 'validators')|desc('A valid email address is required') }}',
            invalidUrl: '{{ 'js.error.invalid_url'|trans({}, 'validators')|desc('A valid URL is required') }}',
            tooLong: '{{ 'js.error.too_long'|trans({}, 'validators')|desc('{fieldName} value should be less than or equal to {maxLength} characters') }}',
            tooShort: '{{ 'js.error.too_short'|trans({}, 'validators')|desc('{fieldName} value should be greater than or equal to {minLength} characters') }}',
            isNotInteger: '{{ 'js.error.is_not_integer'|trans({}, 'validators')|desc('{fieldName} value should be an integer') }}',
            isNotFloat: '{{ 'js.error.is_not_float'|trans({}, 'validators')|desc('{fieldName} value should be a float number') }}',
            isLess: '{{ 'js.error.is_less'|trans({}, 'validators')|desc('{fieldName} value should be greater than or equal to {minValue}') }}',
            isGreater: '{{ 'js.error.is_greater'|trans({}, 'validators')|desc('{fieldName} value should be less than or equal to {maxValue}') }}',
            invalidFileSize: '{{ 'js.error.invalid_file_size'|trans({}, 'validators')|desc('{fieldName}: Cannot upload. File exceeds file size limit.') }}',
            provideLatitudeValue: '{{ 'js.error.provide_latitude_value'|trans({}, 'validators')|desc('Provide latitude value in the Latitude field') }}',
            provideLongitudeValue: '{{ 'js.error.provide_longitude_value'|trans({}, 'validators')|desc('Provide longitude value in the Longitude field') }}',
            addressNotFound: '{{ 'js.error.address_not_found'|trans({}, 'validators')|desc('Provided address does not exist') }}',
            notSamePasswords: '{{ 'js.error.not_same_passwords'|trans({}, 'validators')|desc('Passwords do not match') }}',
            invalidValue: '{{ 'js.error.invalid_value'|trans({}, 'validators')|desc('{fieldName} field has invalid values') }}',
            outOfRangeValue: '{{ 'js.error.out_of_range_value'|trans({}, 'validators')|desc('{fieldName} field value is out of range. The value has to be between {min} and {max}') }}'
          });

          window.CKEDITOR_BASEPATH = window.ALLOYEDITOR_BASEPATH = "/bundles/ezplatformadminuiassets/vendors/alloyeditor/dist/alloy-editor/";
        </script>
        <script src="/bundles/fosjsrouting/js/router.js"></script>
        <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>

        {% stylesheets filter='scssphp'
            'bundles/ezplatformadminui/scss/ezplatform-bootstrap.scss'
            'bundles/ezplatformadminui/scss/ezplatform.scss'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/flatpickr/dist/flatpickr.min.css'
        %}
            <link rel="stylesheet" href="{{ asset_url }}" />
        {% endstylesheets %}
        {% block stylesheets %}{% endblock %}
        <link rel="icon" type="image/x-icon" href="{{ asset('bundles/ezplatformadminui/img/favicon.ico') }}" />
        {{ ezplatform_admin_ui_component_group('stylesheet-head') }}
        {{ ezplatform_admin_ui_component_group('script-head') }}
        {% block page_head %}
            <title>{{ title|default('Home') }}</title>
        {% endblock %}

        {% block head_styles %}
            {% stylesheets filter='scssphp'
                'assets/scss/demo.scss'
            %}
                <link rel="stylesheet" href="{{ asset_url }}" />
            {% endstylesheets %}
        {% endblock %}

    </head>
    <body>
        {% block toolbar %}
            {{ render_esi(controller('Gie\\EzToolbarBundle\\Controller\\ToolbarController:renderAction', {
                locationId: location is defined ? location.id
            })) }}
        {% endblock %}

        {% block header %}
            {{ render_esi(controller('app.controller.menu:getChildNodesAction', {
                template: '@ezdesign/layout/header.html.twig',
                pathString: location is defined ? location.pathString
            })) }}
        {% endblock %}

        {% block ez_recommendations %}
        {% endblock %}

        {% block content %}
        {% endblock %}

        <div
                class="ez-notifications-container"
                data-notifications="{{ app.flashes|json_encode() }}"
                data-template="{{ include('@ezdesign/parts/notification.html.twig', {
                    label: '{{ label }}',
                    message: '{{ message }}'
                })|e('html_attr')  }}"></div>
        <div class="ez-modal-wrapper"></div>
        {%  javascripts
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/react/umd/react.production.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/react-dom/umd/react-dom.production.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/jquery/dist/jquery.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/popper.js/dist/umd/popper.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/bootstrap/dist/js/bootstrap.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/create-react-class/create-react-class.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/prop-types/prop-types.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/flatpickr/dist/flatpickr.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/moment/min/moment.min.js'
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/moment-timezone/builds/moment-timezone-with-data.min.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/admin.format.date.js'
            '@BazingaJsTranslationBundle/Resources/public/js/translator.min.js'
            'js/translations/config.js'
            'js/translations/*.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/core/draggable.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/core/custom.dropdown.js'
        %}
            <script type="text/javascript" src="{{ asset_url }}"></script>
        {% endjavascripts %}

        {{ ezplatform_admin_ui_component_group('custom-admin-ui-modules') }}
        {{ ezplatform_admin_ui_component_group('custom-admin-ui-config') }}
        {%  javascripts
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/helpers/request.helper.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/helpers/notification.helper.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/helpers/timezone.helper.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/admin.notifications.js'
            '@EzPlatformAdminUiModulesBundle/Resources/public/js/UniversalDiscovery.module.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/button.trigger.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/button.prevent.default.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/udw/browse.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/admin.user.menu.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/admin.prevent.click.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/admin.picker.js'
            '@EzPlatformAdminUiBundle/Resources/public/js/scripts/admin.notifications.modal.js'
        %}
            <script type="text/javascript" src="{{ asset_url }}"></script>
        {% endjavascripts %}
        {# CKEditor is not compatible with 'use strict' mode, React 16 force 'use strict' on the entire file.
           CKEditor and React 16 cannot be compiled into one file by assetic #}
        {%  javascripts
            '@EzPlatformAdminUiAssetsBundle/Resources/public/vendors/alloyeditor/dist/alloy-editor/alloy-editor-no-react-min.js'
        %}
            <script type="text/javascript" src="{{ asset_url }}"></script>
        {% endjavascripts %}
        {% block react_modules %}{% endblock %}
        {% block javascripts %}
            <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
                    integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
                    crossorigin=""></script>
        {% endblock %}
        {{ ezplatform_admin_ui_component_group('stylesheet-body') }}
        {{ ezplatform_admin_ui_component_group('script-body') }}

        {% block footer %}
            {{ render_esi(controller('app.controller.menu:getChildNodesAction', {
                template: '@ezdesign/layout/footer.html.twig',
                pathString: location is defined ? location.pathString
            })) }}
        {% endblock %}

        {% javascripts
            'bundles/ezplatformadminuiassets/vendors/jquery/dist/jquery.min.js'
            'bundles/ezplatformadminuiassets/vendors/popper.js/dist/umd/popper.min.js'
            'bundles/ezplatformadminuiassets/vendors/bootstrap/dist/js/bootstrap.min.js'
            'assets/js/blocks/placesMapLoader.js'
            'assets/js/main.js'
        %}
            <script type="text/javascript" src="{{ asset_url }}"></script>
        {% endjavascripts %}


    </body>
</html>
